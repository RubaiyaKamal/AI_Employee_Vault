version: '3.8'

services:
  # Communication MCP Server
  communication-mcp:
    build:
      context: .
      dockerfile: Dockerfile.mcp
    container_name: communication-mcp
    ports:
      - "3001:3001"
    environment:
      - MCP_SERVER_ID=communication-mcp
      - MCP_SERVER_PORT=3001
      - SMTP_HOST=${SMTP_HOST}
      - SMTP_PORT=${SMTP_PORT}
      - SMTP_USER=${SMTP_USER}
      - SMTP_PASS=${SMTP_PASS}
      - LINKEDIN_CLIENT_ID=${LINKEDIN_CLIENT_ID}
      - LINKEDIN_CLIENT_SECRET=${LINKEDIN_CLIENT_SECRET}
    volumes:
      - ./logs:/app/logs
      - ./data:/app/data
    restart: unless-stopped
    command: node mcp_servers/communication_mcp_server.js

  # Business Operations MCP Server
  business-operations-mcp:
    build:
      context: .
      dockerfile: Dockerfile.mcp
    container_name: business-operations-mcp
    ports:
      - "3002:3002"
    environment:
      - MCP_SERVER_ID=business-operations-mcp
      - MCP_SERVER_PORT=3002
      - DATABASE_URL=${DATABASE_URL}
    volumes:
      - ./logs:/app/logs
      - ./data:/app/data
    restart: unless-stopped
    command: node mcp_servers/business_operations_mcp_server.js

  # Personal Assistance MCP Server
  personal-assistance-mcp:
    build:
      context: .
      dockerfile: Dockerfile.mcp
    container_name: personal-assistance-mcp
    ports:
      - "3003:3003"
    environment:
      - MCP_SERVER_ID=personal-assistance-mcp
      - MCP_SERVER_PORT=3003
    volumes:
      - ./logs:/app/logs
      - ./data:/app/data
    restart: unless-stopped
    command: node mcp_servers/personal_assistance_mcp_server.js

  # Integration MCP Server
  integration-mcp:
    build:
      context: .
      dockerfile: Dockerfile.mcp
    container_name: integration-mcp
    ports:
      - "3004:3004"
    environment:
      - MCP_SERVER_ID=integration-mcp
      - MCP_SERVER_PORT=3004
      - COMMUNICATION_MCP_URL=http://communication-mcp:3001
      - BUSINESS_OPS_MCP_URL=http://business-operations-mcp:3002
      - PERSONAL_ASSIST_MCP_URL=http://personal-assistance-mcp:3003
    volumes:
      - ./logs:/app/logs
      - ./data:/app/data
    restart: unless-stopped
    depends_on:
      - communication-mcp
      - business-operations-mcp
      - personal-assistance-mcp
    command: node mcp_servers/integration_mcp_server.js

  # Weekly Audit Scheduler
  audit-scheduler:
    build:
      context: .
      dockerfile: Dockerfile.core
    container_name: audit-scheduler
    environment:
      - NODE_ENV=production
    volumes:
      - ./logs:/app/logs
      - ./data:/app/data
      - ./reports:/app/reports
    restart: unless-stopped
    command: node core_systems/audit_scheduler.js

volumes:
  logs:
  data:
  reports:

networks:
  default:
    name: gold-tier-network
